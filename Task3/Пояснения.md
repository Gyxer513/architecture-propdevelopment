# Требования к безопасности и взаимодействию между системами

## 1. Требования к безопасности

### 1.1. Защищённые каналы передачи данных

- Все взаимодействия между системами **PropDevelopment** и внешней платформой должны осуществляться исключительно по защищённым протоколам:
    - Пример: `HTTPS/TLS 1.2` или выше.
- Рекомендуется использование дополнительного шифрования на уровне:
    - **VPN**
    - **IPsec** (между инфраструктурами)

---

### 1.2. Изоляция и контроль точек обмена

- Внешние вызовы с/на платформу разрешаются **только через заранее согласованный шлюз**, например:
    - API Gateway
    - DMZ (Demilitarized Zone)
    - Reverse Proxy
- Подключение из интернета разрешается **исключительно к строго определённым конечным точкам**:
    - Использование **IP whitelist** или **CIDR-диапазонов**

---

### 1.3. Защита от атак

- На уровне шлюза и интеграционных сервисов **обязательно применение WAF** (Web Application Firewall).
- Обязательные меры защиты:
    - **Rate limiting** (ограничение количества запросов)
    - Защита от:
        - DDoS-атак
        - Brute-force атак
        - Injection-атак (SQLi, XSS и др.)

---

### 1.4. Безопасное хранение и передача данных

- **Персональные и биометрические данные**:
    - Не хранятся в системе PropDevelopment.
    - Управление осуществляется **исключительно внешним партнёром**.
- **Журналы доступа и аудита**:
    - Ведутся в обязательном порядке.
    - Хранятся в зашифрованном виде.
    - Срок хранения — **не менее 1 года**.

---

## 2. Протоколы аутентификации и авторизации

### 2.1. Аутентификация

- Взаимодействие между мобильным приложением, шлюзом PropDevelopment и внешней платформой реализуется с использованием современных протоколов:
    - **OAuth 2.0 / OpenID Connect (OIDC)** — для авторизации пользователя и выдачи `access token`.
    - **JWT (JSON Web Token)** — для передачи информации о правах доступа.
- Мобильное приложение получает токен после прохождения авторизации через:
    - Корпоративный **auth-сервис (SSO)**, интегрированный с системой (например, Active Directory, Keycloak и др.).
- Все сервисы **обязаны проверять**:
    - Валидность токена
    - Срок его действия
    - Подпись и издателя (на каждом вызове)

---

### 2.2. Авторизация

- Реализуется **матрица разрешений** на уровне интеграционного сервиса:
    - Кто (пользователь/роль)
    - К какому устройству
    - Когда
    - Каким образом получает доступ
- Применяется принцип **минимума необходимых прав** (*Principle of Least Privilege*).
- Управление привилегиями — централизованное, с возможностью аудита.

---

## 3. Организация взаимодействия между системами

### 3.1. Общая архитектура

- Все внешние подключения происходят через **выделенный интеграционный сервис** (шлюз PropDevelopment), который:
    - Проксирует запросы от мобильного приложения к внешней платформе партнёра.
- **Прямое взаимодействие** между мобильным приложением и внешней платформой:
    - **Запрещено** без участия внутреннего шлюза/контроллера.

---

### 3.2. Обмен данными

- Основной формат взаимодействия:
    - **REST API** с передачей данных в формате **JSON over HTTPS**.
- Рекомендации:
    - Структурированный обмен по **подписанным схемам**:
        - JSON Schema
        - OpenAPI/Swagger
- Для критичных операций (например, разблокировка доступа):
    - Требуется **подтверждение со стороны PropDevelopment**.
    - Возможна реализация:
        - Двухфакторного подтверждения (2FA)
        - Challenge-response механизмов

---

### 3.3. Аудит и логирование

- **Все вызовы** (успешные и неуспешные) подлежат обязательному логированию.
- Логи:
    - Доступны **ограниченному кругу сотрудников**.
    - Защищены механизмами **RBAC (Role-Based Access Control)**.
    - Регулярно анализируются на предмет подозрительной активности.

---

### 3.4. Соглашения об ответственности

- На уровне **договора** с внешним партнёром определяется:
    - Ответственность за безопасность данных.
    - Процедуры реагирования на инциденты:
        - Утечки данных
        - Нештатные ситуации
        - Подозрительная активность
- Должны быть прописаны:
    - Механизмы уведомления
    - Порядок взаимодействия
    - SLA по реагированию